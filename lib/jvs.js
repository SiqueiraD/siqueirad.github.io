console.log('inicializa arquivo js');

var points = [];
var layers_mark = [];
var i_points = 0;
var layers_polygon = [];
var i_polygons = 0;

function INITIALFUNTION() {
    function onMapClick(e) {
        points[i_points] = e.latlng;
        layers_mark[i_points] = L.marker(points[i_points]).addTo(mymap);
        layers_mark[i_points].on('click', click_mark);
        i_points++;
    }

    mymap.on('click', onMapClick);

    mymap.setMinZoom(15);
    mymap.setMaxBounds(mymap.getBounds());

    montaUFFs();
}

function montaUFFs(){
    var grags = '[[{"lat":-22.90118683637209,"lng":-43.135880827903755},{"lat":-22.901275784789366,"lng":-43.13497424125672},{"lat":-22.900198516699678,"lng":-43.13264608383179},{"lat":-22.89988719451135,"lng":-43.13214719295502},{"lat":-22.898770382051634,"lng":-43.13141226768494},{"lat":-22.89772274430632,"lng":-43.130704164505005},{"lat":-22.89716927204246,"lng":-43.12984049320221},{"lat":-22.89671957416535,"lng":-43.128912448883064},{"lat":-22.896368709951233,"lng":-43.12820971012116},{"lat":-22.896235282476713,"lng":-43.12751233577729},{"lat":-22.895726280165057,"lng":-43.1275498867035},{"lat":-22.895558259565277,"lng":-43.128987550735474},{"lat":-22.89504431290948,"lng":-43.12908411026002},{"lat":-22.895587910274465,"lng":-43.12925040721894},{"lat":-22.89616609780864,"lng":-43.13079535961152},{"lat":-22.896966661095544,"lng":-43.13348829746247},{"lat":-22.89769309406371,"lng":-43.13567161560059},{"lat":-22.89817738054803,"lng":-43.13556969165803},{"lat":-22.898696257005454,"lng":-43.135462403297424},{"lat":-22.899600579801465,"lng":-43.13525855541229},{"lat":-22.900445597292933,"lng":-43.13564479351044}]]';
    var j1 = JSON.parse(grags);
    var pv = '[[{"lat":-22.904606366870222,"lng":-43.13007652759553},{"lat":-22.90382561461241,"lng":-43.1304144859314},{"lat":-22.90308933146624,"lng":-43.13110649585724},{"lat":-22.902451875044022,"lng":-43.131964802742004},{"lat":-22.902278921234434,"lng":-43.132860660552986},{"lat":-22.902348102784735,"lng":-43.133096694946296},{"lat":-22.902605062519765,"lng":-43.13334882259369},{"lat":-22.903064623908794,"lng":-43.133686780929565},{"lat":-22.903469827282503,"lng":-43.133842349052436},{"lat":-22.903751492328986,"lng":-43.1339979171753},{"lat":-22.903751492328986,"lng":-43.13524782657623},{"lat":-22.90427528893007,"lng":-43.135129809379585},{"lat":-22.904724961756635,"lng":-43.13496351242066},{"lat":-22.90538711463296,"lng":-43.134641647338874},{"lat":-22.906335865357608,"lng":-43.133842349052436},{"lat":-22.906958479413067,"lng":-43.13322544097901},{"lat":-22.907437791460517,"lng":-43.132603168487556},{"lat":-22.90805545912614,"lng":-43.13132643699647},{"lat":-22.90807522444497,"lng":-43.13101530075074},{"lat":-22.907877571126928,"lng":-43.130875825881965},{"lat":-22.90709683770381,"lng":-43.13183069229127},{"lat":-22.90652363815161,"lng":-43.13258707523347},{"lat":-22.905940553362395,"lng":-43.13291966915131}]]';
    var j2 = JSON.parse(pv);
    var ninho = '[[{"lat":-22.906617524451107,"lng":-43.13006043434143},{"lat":-22.906311158391667,"lng":-43.130108714103706},{"lat":-22.90618762349445,"lng":-43.12975466251374},{"lat":-22.90479908350799,"lng":-43.12956154346467},{"lat":-22.903914561299043,"lng":-43.12629461288453},{"lat":-22.903894795373716,"lng":-43.12599956989288},{"lat":-22.90564901002752,"lng":-43.125624060630805},{"lat":-22.90618762349445,"lng":-43.12606930732728},{"lat":-22.90700295173621,"lng":-43.12697589397431},{"lat":-22.907314257589743,"lng":-43.12871396541596},{"lat":-22.907116603162397,"lng":-43.12934696674347},{"lat":-22.906577993385557,"lng":-43.12974393367768}]]';
    var j3 = JSON.parse(ninho);

    L.polygon(j1, {
        color: 'purple'
    }).addTo(mymap);

    L.polygon(j2, {
        color: 'red'
    }).addTo(mymap);

    L.polygon(j3, {
        color: 'green'
    }).addTo(mymap);
}

function click_mark(evt) {

    layers_polygon[i_polygons] = L.polygon(points, {
        color: 'red'
    }).addTo(mymap);
    for (var i = i_points - 1; i >= 0; i--) {
        layers_mark[i].remove();
    }
    points = [];
    i_points = 0;
    i_polygons++;

}